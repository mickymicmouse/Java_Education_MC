# 자바 스프링

### 스프링이란

* 자바 플랫폼을 위한 오픈소스 애플리케이션 프레임워크
* 동적 사이트를 만들기 위해 필요한 여러가지 서비스 제공



### 장점

1. 가볍다.
2. 종속 객체 주입
   * 어떤 객체에 의존 관계가 있는 다른 객체를 생성하거나 찾아오지 않아도 종속 객체가 주어짐
   * 낮은 결합도 유지
3. 에스펙트 지향
   * 스프링에서 지원하는 에스펙트 지향 프로그램 aop 는 비즈니스 로직과 시스템 서비스 보안 트랜잭션 로깅 등을 분리해서 개발 가능



### Anotation

* Dependency Injection
* 직접 생성하지 않고 자동화시킴

```java
@Configuration
@Bean
@DependsOn
@Primary
@Lazy
@Import
@ImportResource
@Value
```



### URL vs URI

* URL - http ~~~ 전체 context
* URI - /board/.../... 앞 주소 뒤에 붙는 상세 경로



### 구조

* jsp - js 

  * header 부분에 script 태그로 연결

* jsp - css

  * header 부분에 link 태그로 연결

* controller - jsp

  * context로 연결 

  * ```java
    @RequestMapping(value = { "/login/loginForm.do", "/member/memberForm.do" }, method =  RequestMethod.GET)
    ```

* controller - service

  * 객체로 연결

  * ```java
    memberVO = memberService.login(member);
    ```

* service - dao

  * 객체로 연결

  * ```java
    vo = memberDAO.loginById(memberVO);
    ```

* dao - database

  * sqlsession으로 연결

  * ```java
    vo = sqlSession.selectOne("mapper.member.loginById",memberVO);
    ```

* vo

  * Value Object 데이터를 저장하는 클래스



### MVC 패턴

* model - view - controller 로 구성되는 디자인 패턴



### 스프링 프로젝트 생성 예제

* 스프링 프로젝트 생성
* 프로젝트명 : logmgr
* top level package 는 mc.sn.loginmgr로 하였을 때, HomeController를 요청하여 현재 시간 출력



* New -> Spring Project MVC pattern 생성
* http://localhost:9090/loginmgr/ 실행
* 자동으로 경로는 top level package 이름을 따라감



### 프로젝트 생성

1. New -> Spring Project MVC pattern 생성
2. 우클릭 -> BuildPath -> tomcat 설정, jdbc 설정

* tomcat servlet 설정
  * `C:\Users\seoun\Downloads\apache-tomcat-9.0.43\lib\servlet-api.jar`
* jdbc 설정
  * `C:\oraclexe\app\oracle\product\11.2.0\server\jdbc\lib\ojdbc6.jar`



### XML

* servlet context xml
  * `webapp->WEB-INF -> spring -> appServlet -> servlet-context.xml`

* jdbc properties
  * `webapp ->WEB-INF -> config ->jdbc->jdbc.properties`

* web xml
  * `webapp ->WEB-INF ->web.xml`



### 용어

* CRUD
  * Create, Read, Update, Delete 의 줄임말
  * 사용자 인터페이스가 갖추어야 할 기능(정보의 참조/검색/갱신)을 가리키는 용어



### CSS 적용

1. webapp -> resources -> css 폴더 생성

2. css 폴더 안에 css 파일 생성

   ```css
   @charset "UTF-8";
   table {
   	border: 1px solid black;
   	border-collapse: collapse;
   	margin: 0 auto;
   }
   
   td {
   	border: 1px solid black;
   }
   ```

3. jsp(자바 서버 페이지) 파일의 헤더 부분에 link 연결

   ```jsp
   <%@ page language="java" contentType="text/html; charset=UTF-8"
       pageEncoding="UTF-8"%>
   <!DOCTYPE html>
   <html>
   <head>
   <meta charset="UTF-8">
   <title>Login</title>
   <link rel = "stylesheet" href = "/testspring/resources/css/mystyle.css">
   </head>
   ```



### js(자바스크립트) 적용

1. webapp -> resources -> js 폴더 생성

2. js 폴더 안에 javascript 파일 생성

   ```javascript
   function checkData(){
   	var flag = false;
   	//alert('welcome');
   	
   	var userId = document.getElementById("userId").value;
   	var password = document.getElementById("password").value;
   	
   	if (userId == ''){
   		alert('아이디 입력하세요');
   	} else{
   		flag = true;
   	}
   	return flag;
   }
   ```

3. jsp 파일의 헤더 부분에 script 연결

   ```jsp
   <%@ page language="java" contentType="text/html; charset=UTF-8"
       pageEncoding="UTF-8"%>
   <!DOCTYPE html>
   <html>
   <head>
   <meta charset="UTF-8">
   <title>Login</title>
   <link rel = "stylesheet" href = "/testspring/resources/css/mystyle.css">
   <script type = "text/javascript" src = "/testspring/resources/js/command.js"></script>
   </head>
   ```

   

### 이미지 연결 연습

* body 의 form 태그 안에 입력

```javascript
<img src = "/testspring/resources/image/duke.png" alt= "이미지 연결 연습">
```



### jsp 에서 데이터 불러오기

```jsp
<%@page import="mc.sn.testspring.member.vo.MemberVO"%>
<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Result</title>
</head>
<body>
Result
<%
	MemberVO vo = (MemberVO)session.getAttribute("member");
	String result = "로그인 정보가 정확하지 않습니다.";
	out.print(vo);
	if (vo!=null){
		result = vo.getName()+"님 정말 반갑습니다. Status Success!!!";
	}
	String alertMessage = "<script>alert('"+result+"')</script>";
	out.print(alertMessage);
	session.invalidate();
%>		


</body>
</html>
```





### 실습 순서

1. IN-Controller-OUT
    --> loginForm.jsp가 호출되는지 확인
2. IN-Copntroller-OUT
    --> login.jsp가 호출되는지 확인
    --> 비즈니스 서비스를 호출하지 않음
3. 비즈니스와  DAO DI 확인
    --> VO
    --> DAO
    --> SERVICE

4. mybatis(마이바티스)에 관련된 파일 확인

5. 전체확인(MVC 확장구조)

